<!DOCTYPE HTML>
<html>
<head>
	<title>Missile</title>
	
	<style>
		body {    
			margin: 10;
			padding: 0;
			display: block;
		}
	</style>

</head>

<body style="width:100%;height:100%;overflow-x:hidden;">
	<div>
		<input type="button" onclick="resetMissile()" value="Reset Missile" style="margin:5px;">
		<textarea id="input" style="margin:5px; width:400px;">((target.pos.sub(this.pos)).scale(4)).sub(this.vel)</textarea><br>
	</div>

	<canvas id="canvas" width=800 height=600></canvas>
</body>

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

<script>
	function Point(x, y){
		this.y = y;
		this.x = x;
		
		this.mag = function(){
			return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));
		}
		
		this.add = function(p){
			return new Point(this.x + p.x, this.y + p.y);
		}
		
		this.sub = function(p){
			return new Point(this.x - p.x, this.y - p.y);
		}
		
		this.mul = function(s){
			return new Point(this.x * s, this.y * s);
		}
		
		this.scale = function(s){
			return new Point((s / this.mag()) * this.x, (s / this.mag()) * this.y);
		}
		
		this.toString = function(){
			return x.toFixed(4) + ', ' + y.toFixed(4);
		}
		
		this.equals = function(p){
			return (this.x == p.x) && (this.y == p.y);
		}
	}
	
	function Dot(x, y){
		var SIZE = 8
	
		this.pos = new Point(x, y);
		
		this.tick = function(){
		
		}
		
		this.render = function(){
			g.fillStyle = "#C0C010";
			g.fillRect(this.pos.x - (SIZE / 2), this.pos.y - (SIZE / 2), SIZE, SIZE);
		}
	}
	
	function Missile(x, y){
		var SIZE = 16;
		var THRUST = 0.05;
		
		var SOURCE = document.getElementById("input");
	
		this.pos = new Point(x, y);
		this.vel = new Point(0, 0);
		this.acc = new Point(0, 0);
		
		this.accref = SOURCE.value;
		
		this.tick = function(){
			this.accref = SOURCE.value;
			
			try{
				this.acc = eval(this.accref);
			}
			catch(err){
				this.acc = this.vel.mul(-1);
				console.log("Bad input.");
			}
			
			this.acc = this.acc.scale(THRUST);
			
			this.vel = this.vel.add(this.acc);
			this.pos = this.pos.add(this.vel);
			
		}
		
		this.render = function(){
			g.fillStyle = "#E00000";
			g.fillRect(this.pos.x - (SIZE / 2), this.pos.y - (SIZE / 2), SIZE, SIZE);
		}
	}
	
	////
	
	var WIDTH = 800;
	var HEIGHT = 600;
	
	var c = document.getElementById("canvas");

	canvas.width = WIDTH;
	canvas.height = HEIGHT;
		
	var g = canvas.getContext("2d");
	
	////
	
	var TPS = 100;
	
	var target = new Dot((Math.random() * (WIDTH - 200)) + 100, (Math.random() * (HEIGHT - 200)) + 100);
	var missile = new Missile(WIDTH / 2, HEIGHT / 2);
	
	////
	
	run = function(){
		target.tick();
		missile.tick();
		
		if(missile.pos.sub(target.pos).mag() < 10){
			target.pos = new Point((Math.random() * (WIDTH - 200)) + 100, (Math.random() * (HEIGHT - 200)) + 100);
		}
		
		////
		
		g.fillStyle = "#F4F4F8";
		g.fillRect(0, 0, WIDTH, HEIGHT);
	
		target.render();
		missile.render();
	}
	
	////
	
	resetMissile = function(){
		missile = new Missile(WIDTH / 2, HEIGHT / 2);
	}
	
	////
	
	var gameloop = setInterval(run, 1000 / TPS);
</script>

</html>